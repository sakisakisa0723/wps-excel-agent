# WPS Excel AI Agent 插件安装说明

## 🎯 插件简介
用自然语言操作 WPS 表格的 AI 助手插件！

## ✨ 功能特点
- 🤖 用自然语言与 Excel 对话，自动执行操作
- 📊 读取/写入单元格、搜索数据、插入公式
- 🎯 Agent 模式：自动规划并执行多步任务
- ⚙️ 支持自定义 OpenAI 兼容 API（Kimi、DeepSeek、OpenAI 等）

## 🖥️ 安装步骤

### 1. 服务器部署

```bash
# 进入项目目录
cd wps-excel-agent-latest

# 安装依赖
npm install

# 构建前端
npm run build

# 启动服务器（默认端口 3890）
node server.js
```

使用 PM2 守护进程（推荐）：
```bash
pm2 start server.js --name wps-excel-agent
```

### 2. WPS 插件配置

在 Windows 上配置文件 `%appdata%\kingsoft\wps\jsaddons\publish.xml`：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<jsplugins>
    <jspluginonline name="Excel AI Agent" url="http://你的服务器IP:3890/" type="et" enable="enable_dev"/>
</jsplugins>
```

重启 WPS 表格即可使用。

## ⚙️ 配置 AI API

首次使用时点击插件右上角的「设置」按钮，填写：

| 配置项 | 示例值 |
|--------|--------|
| **Base URL** | `https://api.moonshot.cn/v1/chat/completions` (Kimi)<br>`https://api.deepseek.com/v1/chat/completions` (DeepSeek) |
| **API Key** | 你的 API 密钥 |
| **模型** | `moonshot-v1-8k` (Kimi)<br>`deepseek-chat` (DeepSeek) |

配置会自动保存到浏览器 localStorage。

## 📝 使用示例

- 「帮我把 A 列的姓名拆分成姓和名」
- 「计算 B 列的平均值并写入 C1」
- 「找出销售额大于 1000 的行」
- 「帮我把这个数据生成一个柱状图」

## ❓ 常见问题

**Q: 插件安装后不显示？**
A: 确保 publish.xml 路径正确，并完全重启 WPS。

**Q: API 返回 401？**
A: 检查 API Key 是否正确，Base URL 是否填写完整（包含 `/v1/chat/completions`）。

**Q: 支持 WPS 个人版吗？**
A: 需要 WPS 专业版或支持 JS 插件的版本。

## 📁 项目结构

```
wps-excel-agent-latest/
├── src/
│   ├── agent/           # Agent 核心逻辑
│   │   ├── llm.js      # LLM API 调用
│   │   ├── loop.js     # Agent 循环
│   │   └── tools.js    # Excel 工具函数
│   ├── components/      # 组件
│   ├── pages/           # 页面
│   │   └── AgentPage.vue  # 主页面
│   ├── router/          # 路由
│   ├── App.vue          # 根组件
│   └── main.js          # 入口
├── server.js            # 生产环境服务器（含代理）
├── vite.config.js       # Vite 配置
└── dist/                # 构建输出
```
